{"ast":null,"code":"import _defineProperty from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\PROYECTOS\\\\chatarreria-front\\\\src\\\\components\\\\data_grid\\\\FormDataGrid.js\";\n\n/**\r\n* CLASS FormDataGrid\r\n*\r\n* Contiene el formulario dinamico del datagrid\r\n*\r\n* @author Hector Morales <warrior1987@gmail.com>\r\n*/\nimport React, { Component } from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport ComboBoxFormDataGrid from './ComboBoxFormDataGrid';\nimport configJson from '../configuration/configuration.json';\nimport { divMouseOver, divMouseOut } from '../configuration/GlobalFunctions';\nimport { insertarActualizarFila, eliminarFilas } from '../api_calls/ApiCalls';\nimport alertify from 'alertifyjs';\nimport '../../css/alertify.css';\nimport './dataGrid.css';\n\nvar FormDataGrid =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(FormDataGrid, _Component);\n\n  function FormDataGrid(props) {\n    var _this;\n\n    _classCallCheck(this, FormDataGrid);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FormDataGrid).call(this, props)); //cargar dinamicamente los estados\n\n    _this.state = {};\n\n    _this.props.parametro.formFields.forEach(function (formFields, i) {\n      if (_this.props.parametro.idRow !== 0) {\n        if (_this.props.parametro.idRow[formFields.field] === '' || _this.props.parametro.idRow[formFields.field] === undefined || _this.props.parametro.idRow[formFields.field] === null) {\n          _this.state[formFields.field] = '';\n        } else {\n          _this.state[formFields.field] = _this.props.parametro.idRow[formFields.field];\n        }\n      } else {\n        if (formFields.type === 'select') {\n          _this.state[formFields.field] = 1;\n        } else {\n          _this.state[formFields.field] = '';\n        }\n      }\n    }); //botones de cancelar y guardar      \n\n\n    _this.handleCancelButton = _this.handleCancelButton.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleSaveButton = _this.handleSaveButton.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleConfirmAction = _this.handleConfirmAction.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(FormDataGrid, [{\n    key: \"handleCancelButton\",\n    value: function handleCancelButton() {\n      this.props.funcionClick(this.props.parametro.mainContainer);\n    }\n  }, {\n    key: \"handleSaveButton\",\n    value: function handleSaveButton(id) {\n      var _this2 = this;\n\n      //recorrido dinamico de los campos y cargar dinamicamente el arrayData\n      var arrayData = {};\n      var errors = 0;\n      this.props.parametro.formFields.forEach(function (formFields, i) {\n        if ((_this2.state[formFields.field] === undefined || _this2.state[formFields.field] === '') && formFields.required === 'true') {\n          alertify.error('Digite el campo ' + formFields.label + '!');\n          errors++;\n          return;\n        } else {\n          arrayData[formFields.field] = _this2.state[formFields.field];\n        }\n      }); //hay errores?\n\n      if (errors > 0) {\n        return;\n      }\n\n      var method = '';\n\n      if (id > 0) {\n        //si es update o insert           \n        method = 'put';\n        arrayData['id'] = id; //mandar el ID\n      } else {\n        method = 'post';\n      } //ajax que llama a la API para insertar o actualizar        \n\n\n      insertarActualizarFila(method, this.props.parametro.apiField, arrayData).then(function (response) {\n        response = response.data;\n\n        if (response.msg === 'error') {\n          alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: ' + response.detail);\n        } else {\n          //aqui es donde refresca el datagrid una vez se han hecho los cambios\n          _this2.props.funcionClick(_this2.props.parametro.mainContainer);\n        }\n      }).catch(function (error) {\n        alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />' + error);\n      });\n    } //manejo dinamico de los estados, con esto actualizo el valor de cualquier campo para enviarlos a la API\n\n  }, {\n    key: \"handleStateChange\",\n    value: function handleStateChange(validation, e) {\n      var ingresado = e.target.value; //validaciones\n\n      if (validation === 'mayusculas') {\n        ingresado = ingresado.toUpperCase();\n      } else if (validation === 'entero') {\n        var event = e || window.event;\n        var tecla = event.which || event.keyCode; //var tecla = (document.all)?e.keyCode:e.which;\n\n        console.log(tecla);\n        if (tecla === 8 //BACKSPACE\n        || tecla === 9 //TAB\n        || tecla === 0 //TAB\n        || tecla === 13 //ENTER\n        ) return true;\n        var patron = /\\d/;\n        var te = String.fromCharCode(tecla);\n        ingresado = patron.test(te);\n      }\n\n      this.setState(_defineProperty({}, e.target.name, ingresado));\n    }\n  }, {\n    key: \"handleDeleteButton\",\n    value: function handleDeleteButton(id) {\n      //boton eliminar\n      alertify.confirm('Confirmacion', 'Esta seguro(a) de eliminar este item?', this.handleConfirmAction.bind(this, id), function () {});\n    }\n  }, {\n    key: \"handleConfirmAction\",\n    value: function handleConfirmAction(id) {\n      var _this3 = this;\n\n      //CODIGO PARA ELIMINAR LA FILA        \n      eliminarFilas(this.props.parametro.apiField, id).then(function (response) {\n        response = response.data;\n\n        if (response.msg === 'error') {\n          alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: ' + response.detail);\n        } else if (response.msg === 'notExist') {\n          alertify.alert('Error!', 'El dato a eliminar no existe!');\n        }\n\n        _this3.props.funcionClick('WelcomePage');\n\n        _this3.props.funcionClick(_this3.props.parametro.mainContainer);\n      }).catch(function (error) {\n        alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />' + error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var titulo = 'Agregar';\n      var id = 0;\n      var field = '';\n\n      if (this.props.parametro.idRow !== 0) {\n        titulo = 'Editar';\n        id = this.props.parametro.idRow.id;\n      }\n\n      return (//carga dinamica del formulario\t  \t\t  \t  \t\n        React.createElement(\"div\", {\n          className: \"container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"content\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"table-responsive mt-4\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"titulo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, titulo, \" \", this.props.parametro.titulo)), React.createElement(\"hr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"table-responsive mb-3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, React.createElement(Form, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, //cargar dinamicamente los campos, dependiendo si es input o select\n        this.props.parametro.formFields.map(function (formFields, i) {\n          if (formFields.type === 'text') {\n            field = React.createElement(Form.Group, {\n              key: i,\n              controlId: \"formBasicTipoCompra\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 164\n              },\n              __self: this\n            }, React.createElement(Form.Label, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 165\n              },\n              __self: this\n            }, formFields.label), React.createElement(Form.Control, {\n              name: formFields.field,\n              type: formFields.type,\n              onChange: _this4.handleStateChange.bind(_this4, formFields.validation),\n              value: _this4.state[formFields.field],\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 166\n              },\n              __self: this\n            }));\n          } else if (formFields.type === 'select') {\n            field = React.createElement(Form.Group, {\n              key: i,\n              controlId: \"formBasicTipoCompra\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 170\n              },\n              __self: this\n            }, React.createElement(Form.Label, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 171\n              },\n              __self: this\n            }, formFields.label), React.createElement(ComboBoxFormDataGrid, {\n              valueName: formFields.valueName,\n              options: formFields.options,\n              apiField: formFields.apiField,\n              dinamic: formFields.dinamic,\n              name: formFields.field,\n              type: formFields.type,\n              functionChange: _this4.handleStateChange.bind(_this4),\n              value: _this4.state[formFields.field],\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 172\n              },\n              __self: this\n            }));\n          }\n\n          return field;\n        }), React.createElement(Button, {\n          id: \"formGridBtnSave\",\n          className: \"float-left mr-3\",\n          variant: \"primary\",\n          onClick: this.handleSaveButton.bind(this, id),\n          style: {\n            backgroundColor: configJson.fondoBotonGrilla\n          },\n          onMouseOut: divMouseOut.bind(this, 'formGridBtnSave', configJson.fondoBotonGrilla),\n          onMouseOver: divMouseOver.bind(this, 'formGridBtnSave', configJson.fondoBotonGrilla),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }, \"GUARDAR\"), React.createElement(Button, {\n          variant: \"secondary\",\n          className: \"float-left mr-3\",\n          onClick: this.handleCancelButton.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, \"CANCELAR\"), this.props.parametro.idRow !== 0 ? React.createElement(Button, {\n          id: \"formGridBtnDelete\",\n          className: \"float-left mr-3\",\n          variant: \"danger\",\n          onClick: this.handleDeleteButton.bind(this, id),\n          onMouseOut: divMouseOut.bind(this, \"formGridBtnDelete\", \"#dc3545\"),\n          onMouseOver: divMouseOver.bind(this, \"formGridBtnDelete\", \"#dc3545\"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }, \"ELIMINAR\") : \"\"))))\n      );\n    }\n  }]);\n\n  return FormDataGrid;\n}(Component);\n\nexport default FormDataGrid;","map":{"version":3,"sources":["C:\\PROYECTOS\\chatarreria-front\\src\\components\\data_grid\\FormDataGrid.js"],"names":["React","Component","Form","Button","ComboBoxFormDataGrid","configJson","divMouseOver","divMouseOut","insertarActualizarFila","eliminarFilas","alertify","FormDataGrid","props","state","parametro","formFields","forEach","i","idRow","field","undefined","type","handleCancelButton","bind","handleSaveButton","handleConfirmAction","funcionClick","mainContainer","id","arrayData","errors","required","error","label","method","apiField","then","response","data","msg","alert","detail","catch","validation","e","ingresado","target","value","toUpperCase","event","window","tecla","which","keyCode","console","log","patron","te","String","fromCharCode","test","setState","name","confirm","titulo","map","handleStateChange","valueName","options","dinamic","backgroundColor","fondoBotonGrilla","handleDeleteButton"],"mappings":"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","sourcesContent":["/**\r\n* CLASS FormDataGrid\r\n*\r\n* Contiene el formulario dinamico del datagrid\r\n*\r\n* @author Hector Morales <warrior1987@gmail.com>\r\n*/\r\n\r\nimport React, { Component } from 'react';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Button from 'react-bootstrap/Button';\r\nimport ComboBoxFormDataGrid from './ComboBoxFormDataGrid';\r\nimport configJson from '../configuration/configuration.json';\r\nimport {divMouseOver,divMouseOut} from '../configuration/GlobalFunctions';\r\nimport {insertarActualizarFila,eliminarFilas} from '../api_calls/ApiCalls';\r\nimport alertify from 'alertifyjs';\r\nimport '../../css/alertify.css';\r\nimport './dataGrid.css'; \r\n\r\nclass FormDataGrid extends Component {\r\n  \t\r\n  \tconstructor(props) {\r\n        super(props);\r\n        //cargar dinamicamente los estados\r\n        this.state = {};\r\n        \r\n        this.props.parametro.formFields.forEach((formFields,i) => {\r\n            if(this.props.parametro.idRow !== 0){                \r\n                if(this.props.parametro.idRow[formFields.field] === '' || this.props.parametro.idRow[formFields.field] === undefined || this.props.parametro.idRow[formFields.field] === null){\r\n                    this.state[formFields.field] = '';\r\n                }\r\n                else{\r\n                    this.state[formFields.field] = this.props.parametro.idRow[formFields.field];             \r\n                }\r\n            }\r\n            else{\r\n                if(formFields.type==='select'){\r\n                    this.state[formFields.field] = 1;            \r\n                }\r\n                else{\r\n                    this.state[formFields.field] = '';         \r\n                }                \r\n            }\r\n        });    \r\n        //botones de cancelar y guardar      \r\n        this.handleCancelButton = this.handleCancelButton.bind(this);\r\n        this.handleSaveButton   = this.handleSaveButton.bind(this);\r\n        this.handleConfirmAction = this.handleConfirmAction.bind(this);\r\n    }   \r\n    handleCancelButton(){\r\n        this.props.funcionClick(this.props.parametro.mainContainer);        \r\n    }\r\n    handleSaveButton(id){\r\n\r\n        //recorrido dinamico de los campos y cargar dinamicamente el arrayData\r\n        var arrayData = {};\r\n        var errors = 0;\r\n\r\n\r\n        this.props.parametro.formFields.forEach((formFields,i) => {\r\n            if((this.state[formFields.field] === undefined || this.state[formFields.field] === '') && formFields.required === 'true'){\r\n                alertify.error('Digite el campo '+formFields.label+'!'); \r\n                errors++;\r\n                return;\r\n            } \r\n            else{\r\n                arrayData[formFields.field] = this.state[formFields.field];\r\n            }\r\n        });\r\n        //hay errores?\r\n        if(errors > 0){\r\n            return;\r\n        }            \r\n      \r\n        var method = '';\r\n\r\n        if(id>0){//si es update o insert           \r\n            method = 'put';\r\n            arrayData['id'] = id;//mandar el ID\r\n        }\r\n        else{            \r\n            method = 'post';\r\n        }        \r\n        //ajax que llama a la API para insertar o actualizar        \r\n        insertarActualizarFila(method,this.props.parametro.apiField,arrayData)\r\n        .then(response => {\r\n            response = response.data;\r\n            if(response.msg === 'error'){\r\n                alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: '+response.detail); \r\n            }\r\n            else {\r\n                //aqui es donde refresca el datagrid una vez se han hecho los cambios\r\n                this.props.funcionClick(this.props.parametro.mainContainer);              \r\n            }\r\n        })\r\n        .catch(function (error) {\r\n            alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />'+error);\r\n        });\r\n    }\r\n    //manejo dinamico de los estados, con esto actualizo el valor de cualquier campo para enviarlos a la API\r\n    handleStateChange(validation,e) {         \r\n        var ingresado = e.target.value; //validaciones\r\n        if(validation === 'mayusculas'){\r\n            ingresado = ingresado.toUpperCase();\r\n        }\r\n        else if(validation === 'entero'){\r\n            var event = e || window.event;\r\n            var tecla = event.which || event.keyCode;\r\n            //var tecla = (document.all)?e.keyCode:e.which;\r\n            console.log(tecla);\r\n            if (tecla===8        //BACKSPACE\r\n                || tecla===9     //TAB\r\n                || tecla===0     //TAB\r\n                || tecla===13    //ENTER\r\n                ) return true;\r\n            var patron = /\\d/;\r\n            var te = String.fromCharCode(tecla);\r\n            ingresado = patron.test(te);            \r\n        }\r\n        this.setState({ [e.target.name]: ingresado });     \r\n    }\r\n    handleDeleteButton(id){//boton eliminar\r\n        alertify.confirm('Confirmacion', 'Esta seguro(a) de eliminar este item?', this.handleConfirmAction.bind(this,id), function(){});\r\n    }   \r\n    handleConfirmAction(id) {        \r\n        //CODIGO PARA ELIMINAR LA FILA        \r\n        eliminarFilas(this.props.parametro.apiField,id)\r\n        .then(response => {            \r\n            response = response.data;\r\n            if(response.msg === 'error'){\r\n                alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: '+response.detail); \r\n            }\r\n            else if(response.msg === 'notExist'){\r\n                alertify.alert('Error!', 'El dato a eliminar no existe!'); \r\n            }\r\n            this.props.funcionClick('WelcomePage'); \r\n            this.props.funcionClick(this.props.parametro.mainContainer);\r\n        })\r\n        .catch(function (error) {\r\n            alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />'+error);\r\n        });        \r\n    }    \r\n  \trender() {\r\n  \t\t  var titulo = 'Agregar';\r\n          var id = 0;\r\n          var field = '';\r\n  \t\t  if(this.props.parametro.idRow !== 0){\r\n  \t\t  \t  titulo = 'Editar';\r\n              id = this.props.parametro.idRow.id;\r\n  \t\t  }          \t\t\t\r\n  \t\t  return (  //carga dinamica del formulario\t  \t\t  \t  \t\r\n  \t  \t\t<div className=\"container\">\r\n                <div className=\"content\">\r\n                    <div className=\"table-responsive mt-4\">\r\n                        <div className=\"titulo\">{titulo} {this.props.parametro.titulo}</div>\r\n                    </div>\r\n                    <hr />\r\n                    <div className=\"table-responsive mb-3\">\t\r\n  \t \t\t    \t\t<Form>\r\n                            {\r\n                                //cargar dinamicamente los campos, dependiendo si es input o select\r\n                                this.props.parametro.formFields.map((formFields,i) => {                                    \r\n                                    if(formFields.type === 'text'){\r\n                                        field = <Form.Group key= {i} controlId=\"formBasicTipoCompra\">\r\n                                                    <Form.Label>{formFields.label}</Form.Label>\r\n                                                    <Form.Control name = {formFields.field} type={formFields.type} onChange={this.handleStateChange.bind(this,formFields.validation)} value={this.state[formFields.field]}/>                               \r\n                                               </Form.Group>\r\n                                    }\r\n                                    else if(formFields.type === 'select'){\r\n                                        field = <Form.Group key= {i} controlId=\"formBasicTipoCompra\">\r\n                                                    <Form.Label>{formFields.label}</Form.Label>\r\n                                                    <ComboBoxFormDataGrid valueName = {formFields.valueName} options = {formFields.options} apiField={formFields.apiField} dinamic={formFields.dinamic} name = {formFields.field} type={formFields.type} functionChange={this.handleStateChange.bind(this)} value={this.state[formFields.field]}/>                               \r\n                                               </Form.Group>\r\n                                    }\r\n                                    return field;\r\n                                })\r\n                            }\t\t\t\t\t\t  \t\t\t\t\t\t\t  \t\t\t\t\t\t  \t\r\n\t\t\t\t\t\t  \t<Button id=\"formGridBtnSave\" className=\"float-left mr-3\" variant=\"primary\" onClick={this.handleSaveButton.bind(this,id)} style={{backgroundColor:configJson.fondoBotonGrilla}} onMouseOut={divMouseOut.bind(this,'formGridBtnSave',configJson.fondoBotonGrilla)} onMouseOver={divMouseOver.bind(this,'formGridBtnSave',configJson.fondoBotonGrilla)}>\r\n\t\t\t\t\t\t  \t  \tGUARDAR\r\n\t\t\t\t\t\t  \t</Button>                                                    \r\n\t\t\t\t\t\t  \t<Button variant=\"secondary\" className=\"float-left mr-3\" onClick={this.handleCancelButton.bind(this)}>\r\n\t\t\t\t\t\t  \t  \tCANCELAR\r\n\t\t\t\t\t\t  \t</Button>\r\n                            {                                \r\n                                this.props.parametro.idRow !== 0 ?\r\n                                    <Button id=\"formGridBtnDelete\" className=\"float-left mr-3\" variant=\"danger\" onClick={this.handleDeleteButton.bind(this,id)} onMouseOut={divMouseOut.bind(this,\"formGridBtnDelete\",\"#dc3545\")} onMouseOver={divMouseOver.bind(this,\"formGridBtnDelete\",\"#dc3545\")}>\r\n                                        ELIMINAR\r\n                                    </Button>                                \r\n                                :  \"\"                                \r\n                            }                            \r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</div> \r\n\t\t\t\t</div> \t  \t \t\t       \r\n\t\t\t</div> \t\r\n  \t  \t);\r\n  \t}\r\n}\r\n\r\nexport default FormDataGrid\r\n"]},"metadata":{},"sourceType":"module"}