{"ast":null,"code":"import _classCallCheck from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"D:\\\\PROYECTOS\\\\recicla\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"D:\\\\PROYECTOS\\\\recicla\\\\src\\\\components\\\\desktop\\\\NameUser.js\";\n\n/**\r\n* CLASS NameUser\r\n*\r\n* Contiene el contenedor del nombre del usuario\r\n*\r\n* @author Hector Morales <warrior1987@gmail.com>\r\n*/\nimport React, { Component } from 'react';\nimport MaterialIcon from 'material-icons-react';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport CustomToggle from './CustomToggleDropdown';\nimport globalState from '../configuration/GlobalState';\nimport configJson from '../configuration/configuration.json';\nimport { divMouseOver, divMouseOut } from '../configuration/GlobalFunctions';\nimport { createStore } from 'redux';\nimport Window from '../window/Window';\nimport { logout, insertarActualizarFila } from '../api_calls/ApiCalls';\nimport alertify from 'alertifyjs';\nimport './desktop.css';\nimport '../../css/alertify.css';\n\nvar NameUser =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NameUser, _Component);\n\n  function NameUser(props) {\n    var _this;\n\n    _classCallCheck(this, NameUser);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NameUser).call(this, props));\n    _this.btnLogoutSession = _this.btnLogoutSession.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      username: '',\n      companyName: '',\n      imagenUser: 'default.png'\n    };\n    return _this;\n  }\n\n  _createClass(NameUser, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {}\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      //traer los datos del store  \n      this.unsubscribe1 = globalState.subscribe(function () {\n        if (globalState.getState().type === \"userData\" && _this2.state.mounted === true) {\n          console.log(_this2.state.mounted);\n          var userData = globalState.getState().userData;\n\n          _this2.setState({\n            username: userData[0].primer_nombre.toUpperCase() + ' ' + userData[0].primer_apellido.toUpperCase()\n          });\n\n          if (userData[0].imagen_usuario !== undefined && userData[0].imagen_usuario !== \"\") {\n            _this2.setState({\n              imagenUser: userData[0].imagen_usuario\n            });\n          }\n        }\n      });\n      this.unsubscribe2 = globalState.subscribe(function () {\n        if (globalState.getState().type === \"companyData\" && _this2.state.mounted === true) {\n          var companyData = globalState.getState().companyData;\n\n          _this2.setState({\n            companyName: companyData[0].razon_social.toUpperCase()\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unsubscribe1();\n      this.unsubscribe2();\n    } //evento cerrar sesion\n\n  }, {\n    key: \"btnLogoutSession\",\n    value: function btnLogoutSession() {\n      //boton de cerrar sesion\n      alertify.confirm('Confirmacion', 'Desea cerrar la sesion?', this.logoutSession.bind(this), function () {});\n    } //abrir la modal\n\n  }, {\n    key: \"handleOpenModal\",\n    value: function handleOpenModal() {\n      //boton de abrir modal        \n      globalState.dispatch({\n        type: \"windowFormDataUser\",\n        params: {\n          visible: true\n        }\n      });\n    } //metodo cerrar sesion\n\n  }, {\n    key: \"logoutSession\",\n    value: function logoutSession() {\n      var _this3 = this;\n\n      //llamar a cerrar sesion en la API\n      logout().then(function (res) {\n        var response = res.data;\n\n        if (response.msg === \"error\") {\n          alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />' + response.detail);\n        } else if (response.msg === \"success\") {\n          _this3.props.history.push('/recicla/'); //me devuelve al login                    \t  \t  \t  \t\n\n        }\n      }).catch(function (err) {\n        alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />' + err);\n      });\n    }\n  }, {\n    key: \"functionUpdateUser\",\n    value: function functionUpdateUser() {\n      //actualizacion de datos de usuario\n      var formDataUser = globalState.getState().formDataUser;\n      insertarActualizarFila('put', 'users', formDataUser).then(function (response) {\n        response = response.data;\n\n        if (response.msg === 'error') {\n          alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: ' + response.detail);\n        } else {\n          globalState.dispatch({\n            type: \"windowFormDataUser\",\n            params: {\n              visible: false\n            }\n          }); //ACTUALIZAR EL GLOBAL STORE  \n\n          globalState.getState().userData[0] = formDataUser;\n        }\n      }).catch(function (error) {\n        alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />' + error);\n      });\n    }\n  }, {\n    key: \"functionChangePassword\",\n    value: function functionChangePassword() {\n      var email = globalState.getState().userData[0].email;\n      globalState.dispatch({\n        type: \"windowResetPassword2\",\n        params: {\n          visible: true,\n          params: {\n            email: email,\n            idWin: \"windowResetPassword2\"\n          }\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var date = new Date();\n      var randomDate = date.getTime();\n      var path = \"http://\" + window.location.hostname + \":5000/\";\n      return (//carga el menu de opciones del usuario  \t  \t\t\n        React.createElement(Dropdown, {\n          id: \"ContenidoDataUser\",\n          className: \"ContenidoUser\",\n          onMouseOut: divMouseOut.bind(this, 'ContenidoDataUser', configJson.fondoMenu),\n          onMouseOver: divMouseOver.bind(this, 'ContenidoDataUser', configJson.fondoMenu),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, React.createElement(Dropdown.Toggle, {\n          as: CustomToggle,\n          id: \"dropdown-custom-components\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"FotoUsuario\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          alt: \"imgAvatar\",\n          src: path + configJson.folderAvatarUser + this.state.imagenUser + '?' + randomDate,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"NombreUsuario\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            width: '100%'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, this.state.username), React.createElement(\"div\", {\n          style: {\n            width: '100%'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, this.state.companyName)), React.createElement(\"div\", {\n          className: \"OptionUsuario\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(MaterialIcon, {\n          size: 24,\n          icon: \"keyboard_arrow_down\",\n          invert: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }))), React.createElement(Dropdown.Menu, {\n          style: {\n            marginTop: '54px',\n            marginLeft: '5px',\n            width: '300px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(Dropdown.Item, {\n          eventKey: \"1\",\n          onClick: this.handleOpenModal.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          id: \"dropdownUserData\",\n          style: {\n            height: '25px'\n          },\n          onMouseOut: divMouseOut.bind(this, 'dropdownUserData', '#ffffff'),\n          onMouseOver: divMouseOver.bind(this, 'dropdownUserData', '#c6c6c6'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            width: '30px',\n            float: 'left'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, React.createElement(MaterialIcon, {\n          size: 24,\n          icon: \"account_circle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          style: {\n            height: '25px',\n            float: 'left',\n            verticalAlign: 'middle',\n            paddingTop: '5px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, \"Datos del Usuario\"))), React.createElement(Dropdown.Item, {\n          eventKey: \"1\",\n          onClick: this.btnLogoutSession.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          id: \"dropdownLogout\",\n          style: {\n            height: '25px'\n          },\n          onMouseOut: divMouseOut.bind(this, 'dropdownLogout', '#ffffff'),\n          onMouseOver: divMouseOver.bind(this, 'dropdownLogout', '#c6c6c6'),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            width: '30px',\n            float: 'left'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, React.createElement(MaterialIcon, {\n          size: 24,\n          icon: \"close\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          style: {\n            height: '25px',\n            float: 'left',\n            verticalAlign: 'middle',\n            paddingTop: '5px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, \"Cerrar Sesi\\xF3n\")))), React.createElement(Window, {\n          id: \"windowFormDataUser\",\n          title: \"Datos del Usuario\",\n          width: \"315px\",\n          height: \"80%\",\n          tbar: [{\n            type: 'boton',\n            icon: 'save',\n            width: '100px',\n            height: '60px',\n            title: 'Actualizar Datos',\n            function: this.functionUpdateUser.bind(this)\n          }, {\n            type: 'boton',\n            icon: 'settings',\n            width: '100px',\n            height: '60px',\n            title: 'Cambiar Password',\n            function: this.functionChangePassword.bind(this)\n          }],\n          componente: \"FormDataUser\",\n          params: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }), React.createElement(Window, {\n          id: \"windowResetPassword2\",\n          title: \"Cambiar Password\",\n          width: \"300px\",\n          height: \"240px\",\n          tbar: \"false\",\n          componente: \"WindowResetPassword\",\n          params: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }))\n      );\n    }\n  }]);\n\n  return NameUser;\n}(Component);\n\nexport default NameUser;","map":{"version":3,"sources":["D:\\PROYECTOS\\recicla\\src\\components\\desktop\\NameUser.js"],"names":["React","Component","MaterialIcon","Dropdown","CustomToggle","globalState","configJson","divMouseOver","divMouseOut","createStore","Window","logout","insertarActualizarFila","alertify","NameUser","props","btnLogoutSession","bind","state","username","companyName","imagenUser","unsubscribe1","subscribe","getState","type","mounted","console","log","userData","setState","primer_nombre","toUpperCase","primer_apellido","imagen_usuario","undefined","unsubscribe2","companyData","razon_social","confirm","logoutSession","dispatch","params","visible","then","res","response","data","msg","alert","detail","history","push","catch","err","formDataUser","error","email","idWin","date","Date","randomDate","getTime","path","window","location","hostname","fondoMenu","folderAvatarUser","width","marginTop","marginLeft","handleOpenModal","height","float","verticalAlign","paddingTop","icon","title","function","functionUpdateUser","functionChangePassword"],"mappings":"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","sourcesContent":["/**\r\n* CLASS NameUser\r\n*\r\n* Contiene el contenedor del nombre del usuario\r\n*\r\n* @author Hector Morales <warrior1987@gmail.com>\r\n*/\r\n\r\nimport React, { Component } from 'react';\r\nimport MaterialIcon from 'material-icons-react';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport CustomToggle from './CustomToggleDropdown';\r\nimport globalState from '../configuration/GlobalState';\r\nimport configJson from '../configuration/configuration.json';\r\nimport {divMouseOver,divMouseOut} from '../configuration/GlobalFunctions';\r\nimport { createStore } from 'redux'; \r\nimport Window from '../window/Window';\r\nimport {logout,insertarActualizarFila} from '../api_calls/ApiCalls';\r\nimport alertify from 'alertifyjs';\r\nimport './desktop.css';\r\nimport '../../css/alertify.css';\r\n\r\nclass NameUser extends Component {\r\n\t  constructor(props) {\r\n        super(props);    \r\n        this.btnLogoutSession = this.btnLogoutSession.bind(this);\r\n        this.state = {            \r\n            username    : '',\r\n            companyName : '',\r\n            imagenUser  : 'default.png',            \r\n        };\r\n    }\r\n    componentWillMount(){\r\n        \r\n    }\r\n    componentDidMount(){//traer los datos del store  \r\n        this.unsubscribe1 = globalState.subscribe( ()=>{             \r\n            if(globalState.getState().type===\"userData\" && this.state.mounted === true){\r\n              console.log(this.state.mounted);\r\n                var userData = globalState.getState().userData;\r\n                this.setState({username   : userData[0].primer_nombre.toUpperCase()+' '+userData[0].primer_apellido.toUpperCase()}) \r\n                if(userData[0].imagen_usuario !== undefined && userData[0].imagen_usuario !== \"\"){\r\n                    this.setState({imagenUser : userData[0].imagen_usuario});\r\n                }\r\n            }\r\n        });\r\n        this.unsubscribe2 = globalState.subscribe( ()=>{ \r\n            if(globalState.getState().type===\"companyData\" && this.state.mounted === true){        \r\n                var companyData = globalState.getState().companyData;       \r\n                this.setState({companyName  : companyData[0].razon_social.toUpperCase()})                \r\n            }\r\n        });        \r\n    }\r\n    componentWillUnmount(){         \r\n        this.unsubscribe1();\r\n        this.unsubscribe2();             \r\n    }\r\n    //evento cerrar sesion\r\n\t  btnLogoutSession(){//boton de cerrar sesion\r\n\t  \t  alertify.confirm('Confirmacion', 'Desea cerrar la sesion?', this.logoutSession.bind(this), function(){});\r\n\t  } \r\n    //abrir la modal\r\n    handleOpenModal(){//boton de abrir modal        \r\n        globalState.dispatch({\r\n                type   : \"windowFormDataUser\",\r\n                params : {\r\n                            visible : true\r\n                         }\r\n            });\r\n    }          \r\n    //metodo cerrar sesion\r\n\t  logoutSession(){//llamar a cerrar sesion en la API\r\n\t \t    logout()\r\n        .then(res => {\r\n            var response = res.data; \r\n          \tif (response.msg === \"error\") {      \t  \t  \t  \t\r\n          \t\talertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />'+response.detail);  \t  \t  \t  \t\r\n          \t} else if (response.msg === \"success\"){\r\n          \t  \tthis.props.history.push('/recicla/');//me devuelve al login                    \t  \t  \t  \t\r\n          \t}\r\n        })\r\n        .catch(err => {\r\n          \talertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />'+err);      \t  \t  \r\n        });\r\n\t  }   \r\n    functionUpdateUser(){\r\n        //actualizacion de datos de usuario\r\n        var formDataUser = globalState.getState().formDataUser; \r\n        insertarActualizarFila('put','users',formDataUser)\r\n        .then(response => {\r\n            response = response.data;\r\n            if(response.msg === 'error'){\r\n                alertify.alert('Error!', 'Ha ocurrido un error accesando a la base de datos!<br />Codigo de Error: '+response.detail); \r\n            }\r\n            else {                \r\n                globalState.dispatch({\r\n                    type   : \"windowFormDataUser\", \r\n                    params : {\r\n                        visible : false\r\n                    }\r\n                });\r\n                //ACTUALIZAR EL GLOBAL STORE  \r\n                globalState.getState().userData[0] = formDataUser;                          \r\n            }\r\n        })\r\n        .catch(function (error) {\r\n            alertify.alert('Error!', 'No se ha logrado la conexion con el servidor!<br />'+error);\r\n        });\r\n    } \r\n    functionChangePassword(){\r\n        var email = globalState.getState().userData[0].email;\r\n        globalState.dispatch({\r\n                type   : \"windowResetPassword2\",\r\n                params : {\r\n                              visible : true,\r\n                              params  : {\r\n                                            email : email,\r\n                                            idWin : \"windowResetPassword2\"\r\n                                        }\r\n                         }\r\n            });        \r\n    } \r\n    render() {\r\n          var date = new Date();\r\n          var randomDate = date.getTime(); \r\n          var path = \"http://\"+window.location.hostname+\":5000/\";\r\n    \t  \treturn (//carga el menu de opciones del usuario  \t  \t\t\r\n        \t\t\t<Dropdown  id=\"ContenidoDataUser\" className=\"ContenidoUser\" onMouseOut={divMouseOut.bind(this,'ContenidoDataUser',configJson.fondoMenu)} onMouseOver={divMouseOver.bind(this,'ContenidoDataUser',configJson.fondoMenu)}>\t\r\n        \t\t\t\t  <Dropdown.Toggle as={CustomToggle} id=\"dropdown-custom-components\">  \t  \t\t\t\t\t \t\t  \r\n      \t\t\t\t    \t  <div className=\"FotoUsuario\">\r\n                          <img alt=\"imgAvatar\" src={path+configJson.folderAvatarUser+this.state.imagenUser+'?'+randomDate} />\r\n                      </div>\r\n                      <div className=\"NombreUsuario\">\r\n                          <div style={{width:'100%'}}>\r\n                              {this.state.username}\r\n                          </div>\r\n                          <div style={{width:'100%'}}>\r\n                              {this.state.companyName}\r\n                          </div>\t\r\n                      </div>\r\n      \t\t\t\t    \t  <div className=\"OptionUsuario\">\r\n      \t\t\t\t    \t  \t<MaterialIcon size={24} icon=\"keyboard_arrow_down\" invert />\r\n      \t\t\t\t    \t  </div>\t\t\t\t\t\r\n      \t\t\t\t    </Dropdown.Toggle>\r\n      \t\t\t\t    <Dropdown.Menu  style={{ marginTop: '54px',marginLeft: '5px',width:'300px'}}>\r\n      \t\t\t\t      \t<Dropdown.Item eventKey=\"1\" onClick={this.handleOpenModal.bind(this)}>\r\n                          <div id=\"dropdownUserData\" style={{height:'25px'}} onMouseOut={divMouseOut.bind(this,'dropdownUserData','#ffffff')} onMouseOver={divMouseOver.bind(this,'dropdownUserData','#c6c6c6')}>\r\n                              <div style={{width:'30px',float:'left'}}>\r\n                                  <MaterialIcon size={24} icon=\"account_circle\" />\r\n                              </div>\r\n                              <div style={{height:'25px',float:'left',verticalAlign:'middle',paddingTop:'5px'}}>\r\n                                  Datos del Usuario\r\n                              </div>\r\n                          </div>\r\n                      </Dropdown.Item>\r\n      \t\t\t\t      \t<Dropdown.Item eventKey=\"1\" onClick={this.btnLogoutSession.bind(this)}>\r\n                          <div id=\"dropdownLogout\" style={{height:'25px'}} onMouseOut={divMouseOut.bind(this,'dropdownLogout','#ffffff')} onMouseOver={divMouseOver.bind(this,'dropdownLogout','#c6c6c6')}>\r\n                              <div style={{width:'30px',float:'left'}}>\r\n                                  <MaterialIcon size={24} icon=\"close\" />\r\n                              </div>\r\n                              <div style={{height:'25px',float:'left',verticalAlign:'middle',paddingTop:'5px'}}>\r\n                                  Cerrar Sesi&oacute;n\r\n                               </div>\r\n                          </div>\r\n                      </Dropdown.Item>\t\t\t\t  \t\r\n      \t\t\t\t    </Dropdown.Menu>   \r\n                  <Window \r\n                      id = \"windowFormDataUser\"                      \r\n                      title='Datos del Usuario'\r\n                      width='315px' \r\n                      height='80%'                     \r\n                      tbar={[\r\n                              {\r\n                                  type : 'boton',\r\n                                  icon : 'save',\r\n                                  width : '100px',\r\n                                  height : '60px',\r\n                                  title : 'Actualizar Datos',\r\n                                  function : this.functionUpdateUser.bind(this)\r\n                              },\r\n                              {\r\n                                  type : 'boton',\r\n                                  icon : 'settings',\r\n                                  width : '100px',\r\n                                  height : '60px',\r\n                                  title : 'Cambiar Password',\r\n                                  function : this.functionChangePassword.bind(this)\r\n                              }    \r\n                           ]}\r\n                      componente=\"FormDataUser\"\r\n                      params=\"\" \r\n                  /> \r\n                  <Window \r\n                      id = \"windowResetPassword2\"                      \r\n                      title='Cambiar Password'\r\n                      width='300px' \r\n                      height='240px'                     \r\n                      tbar='false'\r\n                      componente=\"WindowResetPassword\"\r\n                      params=\"\" \r\n                  />                  \r\n      \t\t\t  </Dropdown>\t              \t    \t\t\r\n\t     );\r\n    }\r\n}\r\n\r\nexport default NameUser"]},"metadata":{},"sourceType":"module"}